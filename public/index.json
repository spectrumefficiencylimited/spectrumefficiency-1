[{"content":"\r\rknitr::opts_chunk$set(echo = TRUE)\rlibrary(tidyverse)\r## Warning: package \u0026#39;tidyverse\u0026#39; was built under R version 3.6.1\r## -- Attaching packages ------------------------------------------------------------------------------------------------------------------------------------ tidyverse 1.2.1 --\r## v ggplot2 3.2.1 v purrr 0.3.2\r## v tibble 2.1.3 v dplyr 0.8.3\r## v tidyr 1.0.0 v stringr 1.4.0\r## v readr 1.3.1 v forcats 0.4.0\r## Warning: package \u0026#39;ggplot2\u0026#39; was built under R version 3.6.1\r## Warning: package \u0026#39;tidyr\u0026#39; was built under R version 3.6.1\r## Warning: package \u0026#39;readr\u0026#39; was built under R version 3.6.1\r## Warning: package \u0026#39;dplyr\u0026#39; was built under R version 3.6.1\r## Warning: package \u0026#39;stringr\u0026#39; was built under R version 3.6.1\r## -- Conflicts --------------------------------------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --\r## x dplyr::filter() masks stats::filter()\r## x dplyr::lag() masks stats::lag()\rtheme_set(theme_light())\rhorror_movies_raw \u0026lt;- readr::read_csv(\u0026quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-22/horror_movies.csv\u0026quot;)\r## Parsed with column specification:\r## cols(\r## title = col_character(),\r## genres = col_character(),\r## release_date = col_character(),\r## release_country = col_character(),\r## movie_rating = col_character(),\r## review_rating = col_double(),\r## movie_run_time = col_character(),\r## plot = col_character(),\r## cast = col_character(),\r## language = col_character(),\r## filming_locations = col_character(),\r## budget = col_character()\r## )\rhorror_movies \u0026lt;- horror_movies_raw %\u0026gt;%\rarrange(desc(review_rating)) %\u0026gt;%\rextract(title, \u0026quot;year\u0026quot;, \u0026quot;\\\\((\\\\d\\\\d\\\\d\\\\d)\\\\)$\u0026quot;, remove = FALSE, convert = TRUE) %\u0026gt;%\rmutate(budget = parse_number(budget)) %\u0026gt;%\rseparate(plot, c(\u0026quot;director\u0026quot;, \u0026quot;cast_sentence\u0026quot;, \u0026quot;plot\u0026quot;), extra = \u0026quot;merge\u0026quot;, sep = \u0026quot;\\\\. \u0026quot;, fill = \u0026quot;right\u0026quot;) %\u0026gt;%\rdistinct(title, .keep_all = TRUE)\rMost of the movies are since 2012.\nhorror_movies %\u0026gt;%\rcount(genres, sort = TRUE)\r## # A tibble: 261 x 2\r## genres n\r## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r## 1 Horror 1048\r## 2 Horror| Thriller 469\r## 3 Comedy| Horror 245\r## 4 Horror| Mystery| Thriller 171\r## 5 Drama| Horror| Thriller 159\r## 6 Drama| Horror 72\r## 7 Horror| Sci-Fi| Thriller 66\r## 8 Drama| Horror| Mystery| Thriller 53\r## 9 Action| Horror| Thriller 48\r## 10 Horror| Mystery 47\r## # ... with 251 more rows\rhorror_movies %\u0026gt;%\rcount(language, sort = TRUE)\r## # A tibble: 188 x 2\r## language n\r## \u0026lt;chr\u0026gt; \u0026lt;int\u0026gt;\r## 1 English 2407\r## 2 Spanish 94\r## 3 Japanese 75\r## 4 \u0026lt;NA\u0026gt; 70\r## 5 Hindi 37\r## 6 Filipino|Tagalog 34\r## 7 Thai 34\r## 8 English|Spanish 30\r## 9 Turkish 29\r## 10 German 28\r## # ... with 178 more rows\rhorror_movies %\u0026gt;%\rggplot(aes(budget)) +\rgeom_histogram() +\rscale_x_log10(labels = scales::dollar)\r## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\r## Warning: Removed 2077 rows containing non-finite values (stat_bin).\rDo higher budget movies end up higher rated?\nhorror_movies %\u0026gt;%\rggplot(aes(budget, review_rating)) +\rgeom_point() +\rscale_x_log10(labels = scales::dollar) +\rgeom_smooth(method = \u0026quot;lm\u0026quot;)\r## Warning: Removed 2163 rows containing non-finite values (stat_smooth).\r## Warning: Removed 2163 rows containing missing values (geom_point).\rNo relationship between budget and rating. How about movie rating and review?\nhorror_movies %\u0026gt;%\rmutate(movie_rating = fct_lump(movie_rating, 5),\rmovie_rating = fct_reorder(movie_rating, review_rating, na.rm = TRUE)) %\u0026gt;%\rggplot(aes(movie_rating, review_rating)) +\rgeom_boxplot() +\rcoord_flip()\r## Warning: Removed 252 rows containing non-finite values (stat_boxplot).\rhorror_movies %\u0026gt;%\rfilter(!is.na(movie_rating)) %\u0026gt;%\rmutate(movie_rating = fct_lump(movie_rating, 5)) %\u0026gt;%\rlm(review_rating ~ movie_rating, data = .) %\u0026gt;%\ranova()\r## Analysis of Variance Table\r## ## Response: review_rating\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## movie_rating 5 70.05 14.0092 9.1759 1.319e-08 ***\r## Residuals 1424 2174.08 1.5267 ## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\rhorror_movies %\u0026gt;%\rseparate_rows(genres, sep = \u0026quot;\\\\| \u0026quot;) %\u0026gt;%\rmutate(genre = fct_lump(genres, 5)) %\u0026gt;%\rggplot(aes(genre, review_rating)) +\rgeom_boxplot()\r## Warning: Removed 421 rows containing non-finite values (stat_boxplot).\rlibrary(tidytext)\r## Warning: package \u0026#39;tidytext\u0026#39; was built under R version 3.6.1\rhorror_movies_unnested \u0026lt;- horror_movies %\u0026gt;%\runnest_tokens(word, plot) %\u0026gt;%\ranti_join(stop_words, by = \u0026quot;word\u0026quot;) %\u0026gt;%\rfilter(!is.na(word))\rhorror_movies_unnested %\u0026gt;%\rfilter(!is.na(review_rating)) %\u0026gt;%\rgroup_by(word) %\u0026gt;%\rsummarize(movies = n(),\ravg_rating = mean(review_rating)) %\u0026gt;%\rarrange(desc(movies)) %\u0026gt;%\rfilter(movies \u0026gt;= 100) %\u0026gt;%\rmutate(word = fct_reorder(word, avg_rating)) %\u0026gt;%\rggplot(aes(avg_rating, word)) +\rgeom_point()\rLasso regression for predicing review rating based on words in plot\rlibrary(glmnet)\r## Warning: package \u0026#39;glmnet\u0026#39; was built under R version 3.6.1\r## Loading required package: Matrix\r## ## Attaching package: \u0026#39;Matrix\u0026#39;\r## The following objects are masked from \u0026#39;package:tidyr\u0026#39;:\r## ## expand, pack, unpack\r## Loading required package: foreach\r## Warning: package \u0026#39;foreach\u0026#39; was built under R version 3.6.1\r## ## Attaching package: \u0026#39;foreach\u0026#39;\r## The following objects are masked from \u0026#39;package:purrr\u0026#39;:\r## ## accumulate, when\r## Loaded glmnet 2.0-18\rlibrary(Matrix)\rmovie_word_matrix \u0026lt;- horror_movies_unnested %\u0026gt;%\rfilter(!is.na(review_rating)) %\u0026gt;%\radd_count(word) %\u0026gt;%\rfilter(n \u0026gt;= 20) %\u0026gt;%\rcount(title, word) %\u0026gt;%\rcast_sparse(title, word, n)\rrating \u0026lt;- horror_movies$review_rating[match(rownames(movie_word_matrix), horror_movies$title)]\rlasso_model \u0026lt;- cv.glmnet(movie_word_matrix, rating)\rlibrary(broom)\r## Warning: package \u0026#39;broom\u0026#39; was built under R version 3.6.2\rtidy(lasso_model$glmnet.fit) %\u0026gt;%\rfilter(term %in% c(\u0026quot;quickly\u0026quot;, \u0026quot;seek\u0026quot;, \u0026quot;army\u0026quot;, \u0026quot;teacher\u0026quot;, \u0026quot;unexpected\u0026quot;, \u0026quot;friends\u0026quot;, \u0026quot;evil\u0026quot;)) %\u0026gt;%\rggplot(aes(lambda, estimate, color = term)) +\rgeom_line() +\rscale_x_log10() +\rgeom_vline(xintercept = lasso_model$lambda.min) +\rgeom_hline(yintercept = 0, lty = 2)\rplot(lasso_model)\rtidy(lasso_model$glmnet.fit) %\u0026gt;%\rfilter(lambda == lasso_model$lambda.min,\rterm != \u0026quot;(Intercept)\u0026quot;) %\u0026gt;%\rmutate(term = fct_reorder(term, estimate)) %\u0026gt;%\rggplot(aes(term, estimate)) +\rgeom_col() +\rcoord_flip()\rThrowing everything into a linear model: director, cast, genre, rating, plot words.\nfeatures \u0026lt;- horror_movies %\u0026gt;%\rfilter(!is.na(review_rating)) %\u0026gt;%\rselect(title, genres, director, cast, movie_rating, language, release_country) %\u0026gt;%\rmutate(director = str_remove(director, \u0026quot;Directed by \u0026quot;)) %\u0026gt;%\rgather(type, value, -title) %\u0026gt;%\rfilter(!is.na(value)) %\u0026gt;%\rseparate_rows(value, sep = \u0026quot;\\\\| ?\u0026quot;) %\u0026gt;%\runite(feature, type, value, sep = \u0026quot;: \u0026quot;) %\u0026gt;%\rmutate(n = 1)\rmovie_feature_matrix \u0026lt;- horror_movies_unnested %\u0026gt;%\rfilter(!is.na(review_rating)) %\u0026gt;%\rcount(title, feature = paste0(\u0026quot;word: \u0026quot;, word)) %\u0026gt;%\rbind_rows(features) %\u0026gt;%\radd_count(feature) %\u0026gt;%\rfilter(n \u0026gt;= 10) %\u0026gt;%\rcast_sparse(title, feature)\rrating \u0026lt;- horror_movies$review_rating[match(rownames(movie_feature_matrix), horror_movies$title)]\rfeature_lasso_model \u0026lt;- cv.glmnet(movie_feature_matrix, rating)\rplot(feature_lasso_model)\rtidy(feature_lasso_model$glmnet.fit) %\u0026gt;%\rfilter(lambda == feature_lasso_model$lambda.1se,\rterm != \u0026quot;(Intercept)\u0026quot;) %\u0026gt;%\rmutate(term = fct_reorder(term, estimate)) %\u0026gt;%\rggplot(aes(term, estimate)) +\rgeom_col() +\rcoord_flip() +\rlabs(x = \u0026quot;\u0026quot;,\ry = \u0026quot;Coefficient for predicting movie rating\u0026quot;,\rtitle = \u0026quot;What affects a horror movie rating?\u0026quot;,\rsubtitle = \u0026quot;Based on a lasso regression to predict IMDb ratings of ~3000 movies\u0026quot;)\rWhat am I going to watch?\nhorror_movies %\u0026gt;%\rfilter(str_detect(genres, \u0026quot;Comedy\u0026quot;),\r!is.na(movie_rating),\r!is.na(budget),\rmovie_rating != \u0026quot;PG\u0026quot;) %\u0026gt;%\rarrange(desc(review_rating)) %\u0026gt;%\rselect(title, review_rating, movie_rating, plot, director, budget, language) %\u0026gt;%\rView()\r\r","description":"","id":0,"section":"posts","tags":[""],"title":"fist post","uri":"/posts/2020-05-08-ooo/"},{"content":"I started a company some years ago intending to act as a conduit between tree entities that work together in a symbiosis relation.\nIn my opinion, these three entities are\n the public the business/professionals the regulator/government.  I have had prior exposure and training with my first job in New Zealand. It is here that I saw this gap that I wanted to address. When I joined Radio Spectrum Management, I quickly realized how deep the rabbit hole goes and that I have only scratched the surface.\nThus Spectrum Efficiency was incorporated:\nDue to conflict of interests, I never pursued the dream of owning a company. I kept the name and it stands for:\n How efficient are you in delivering a specific communication given that you only have a certain amount of time to do it.\n The values that it is built on are\nProfessionalism  I want to share thoughts and have opinions about various topics within the telecommunications industry.  Accuracy  I want to always base my opinions on facts and provide a reproducible report.  Optimized  I want to provide the easiest most efficient way to consume this information.  ","description":"Radio Frequency Spectrum Management unleashed by data automation.","id":1,"section":"posts","tags":["contact","spectrum management","data automation","R","Dashboard"],"title":"Spectrum Efficiency","uri":"/posts/contact-us/"},{"content":"I like building data process. A lot. And, unlike my stakeholders, I consider change, just the necessary step, that when implemented together, it makes a significant impact in their work life. Luckily for my stakeholders, I like resolving the business challenges even more.\nI also quite like data visualization â€“ charts and dashboards like sharable data interactions using the Shiny framework. Yes, I like looking at youtube videos of other people building data dashboards in my spare time.\nI amounted to more than ten+ years of experience in the telecommunication industry, and the last three years have been within the government.\nWhen not eagerly anticipating my next innovation challenge, I will be doing something daunting like diving, mountain biking, snowboarding, or else running or at the gym.\nMMIM - Victoria University of Wellington, New Zealand\nARE176\nGovernment Regulatory Practice Initiative level 4.\nLearn more and contribute on GitHub.\n","description":"Radio Frequency Spectrum Management unleashed by data automation.","id":2,"section":"","tags":["R","dashboard","profile","story","qualifications","experience","gender neutral","stakeholders","contact","spectrum management","data automation"],"title":"Spectrum Efficiency","uri":"/about/"}]