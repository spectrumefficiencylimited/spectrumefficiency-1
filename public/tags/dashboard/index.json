[{"content":"knitr::opts_chunk$set(echo = TRUE) library(tidyverse) theme_set(theme_light()) horror_movies_raw \u0026lt;- readr::read_csv(\u0026quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-22/horror_movies.csv\u0026quot;) horror_movies \u0026lt;- horror_movies_raw %\u0026gt;% arrange(desc(review_rating)) %\u0026gt;% extract(title, \u0026quot;year\u0026quot;, \u0026quot;\\\\((\\\\d\\\\d\\\\d\\\\d)\\\\)$\u0026quot;, remove = FALSE, convert = TRUE) %\u0026gt;% mutate(budget = parse_number(budget)) %\u0026gt;% separate(plot, c(\u0026quot;director\u0026quot;, \u0026quot;cast_sentence\u0026quot;, \u0026quot;plot\u0026quot;), extra = \u0026quot;merge\u0026quot;, sep = \u0026quot;\\\\. \u0026quot;, fill = \u0026quot;right\u0026quot;) %\u0026gt;% distinct(title, .keep_all = TRUE) Most of the movies are since 2012.\nhorror_movies %\u0026gt;% count(genres, sort = TRUE) horror_movies %\u0026gt;% count(language, sort = TRUE) horror_movies %\u0026gt;% ggplot(aes(budget)) + geom_histogram() + scale_x_log10(labels = scales::dollar) Do higher budget movies end up higher rated?\nhorror_movies %\u0026gt;% ggplot(aes(budget, review_rating)) + geom_point() + scale_x_log10(labels = scales::dollar) + geom_smooth(method = \u0026quot;lm\u0026quot;) No relationship between budget and rating. How about movie rating and review?\nhorror_movies %\u0026gt;% mutate(movie_rating = fct_lump(movie_rating, 5), movie_rating = fct_reorder(movie_rating, review_rating, na.rm = TRUE)) %\u0026gt;% ggplot(aes(movie_rating, review_rating)) + geom_boxplot() + coord_flip() horror_movies %\u0026gt;% filter(!is.na(movie_rating)) %\u0026gt;% mutate(movie_rating = fct_lump(movie_rating, 5)) %\u0026gt;% lm(review_rating ~ movie_rating, data = .) %\u0026gt;% anova() horror_movies %\u0026gt;% separate_rows(genres, sep = \u0026quot;\\\\| \u0026quot;) %\u0026gt;% mutate(genre = fct_lump(genres, 5)) %\u0026gt;% ggplot(aes(genre, review_rating)) + geom_boxplot() library(tidytext) horror_movies_unnested \u0026lt;- horror_movies %\u0026gt;% unnest_tokens(word, plot) %\u0026gt;% anti_join(stop_words, by = \u0026quot;word\u0026quot;) %\u0026gt;% filter(!is.na(word)) horror_movies_unnested %\u0026gt;% filter(!is.na(review_rating)) %\u0026gt;% group_by(word) %\u0026gt;% summarize(movies = n(), avg_rating = mean(review_rating)) %\u0026gt;% arrange(desc(movies)) %\u0026gt;% filter(movies \u0026gt;= 100) %\u0026gt;% mutate(word = fct_reorder(word, avg_rating)) %\u0026gt;% ggplot(aes(avg_rating, word)) + geom_point() Lasso regression for predicing review rating based on words in plot library(glmnet) library(Matrix) movie_word_matrix \u0026lt;- horror_movies_unnested %\u0026gt;% filter(!is.na(review_rating)) %\u0026gt;% add_count(word) %\u0026gt;% filter(n \u0026gt;= 20) %\u0026gt;% count(title, word) %\u0026gt;% cast_sparse(title, word, n) rating \u0026lt;- horror_movies$review_rating[match(rownames(movie_word_matrix), horror_movies$title)] lasso_model \u0026lt;- cv.glmnet(movie_word_matrix, rating) library(broom) tidy(lasso_model$glmnet.fit) %\u0026gt;% filter(term %in% c(\u0026quot;quickly\u0026quot;, \u0026quot;seek\u0026quot;, \u0026quot;army\u0026quot;, \u0026quot;teacher\u0026quot;, \u0026quot;unexpected\u0026quot;, \u0026quot;friends\u0026quot;, \u0026quot;evil\u0026quot;)) %\u0026gt;% ggplot(aes(lambda, estimate, color = term)) + geom_line() + scale_x_log10() + geom_vline(xintercept = lasso_model$lambda.min) + geom_hline(yintercept = 0, lty = 2) plot(lasso_model) tidy(lasso_model$glmnet.fit) %\u0026gt;% filter(lambda == lasso_model$lambda.min, term != \u0026quot;(Intercept)\u0026quot;) %\u0026gt;% mutate(term = fct_reorder(term, estimate)) %\u0026gt;% ggplot(aes(term, estimate)) + geom_col() + coord_flip() Throwing everything into a linear model: director, cast, genre, rating, plot words.\nfeatures \u0026lt;- horror_movies %\u0026gt;% filter(!is.na(review_rating)) %\u0026gt;% select(title, genres, director, cast, movie_rating, language, release_country) %\u0026gt;% mutate(director = str_remove(director, \u0026quot;Directed by \u0026quot;)) %\u0026gt;% gather(type, value, -title) %\u0026gt;% filter(!is.na(value)) %\u0026gt;% separate_rows(value, sep = \u0026quot;\\\\| ?\u0026quot;) %\u0026gt;% unite(feature, type, value, sep = \u0026quot;: \u0026quot;) %\u0026gt;% mutate(n = 1) movie_feature_matrix \u0026lt;- horror_movies_unnested %\u0026gt;% filter(!is.na(review_rating)) %\u0026gt;% count(title, feature = paste0(\u0026quot;word: \u0026quot;, word)) %\u0026gt;% bind_rows(features) %\u0026gt;% add_count(feature) %\u0026gt;% filter(n \u0026gt;= 10) %\u0026gt;% cast_sparse(title, feature) rating \u0026lt;- horror_movies$review_rating[match(rownames(movie_feature_matrix), horror_movies$title)] feature_lasso_model \u0026lt;- cv.glmnet(movie_feature_matrix, rating) plot(feature_lasso_model) tidy(feature_lasso_model$glmnet.fit) %\u0026gt;% filter(lambda == feature_lasso_model$lambda.1se, term != \u0026quot;(Intercept)\u0026quot;) %\u0026gt;% mutate(term = fct_reorder(term, estimate)) %\u0026gt;% ggplot(aes(term, estimate)) + geom_col() + coord_flip() + labs(x = \u0026quot;\u0026quot;, y = \u0026quot;Coefficient for predicting movie rating\u0026quot;, title = \u0026quot;What affects a horror movie rating?\u0026quot;, subtitle = \u0026quot;Based on a lasso regression to predict IMDb ratings of ~3000 movies\u0026quot;) What am I going to watch?\nhorror_movies %\u0026gt;% filter(str_detect(genres, \u0026quot;Comedy\u0026quot;), !is.na(movie_rating), !is.na(budget), movie_rating != \u0026quot;PG\u0026quot;) %\u0026gt;% arrange(desc(review_rating)) %\u0026gt;% select(title, review_rating, movie_rating, plot, director, budget, language) %\u0026gt;% View() ","description":"","id":0,"section":"posts","tags":[""],"title":"fist post","uri":"https://www.spectrumefficiency.co.nz/posts/2020-05-08-ooo/"},{"content":"I started a company some years ago intending to act as a conduit between tree entities that work together in a symbiosis relation.\nIn my opinion, these three entities are\n the public the business/professionals the regulator/government.  I have had prior exposure and training with my first job in New Zealand. It is here that I saw this gap that I wanted to address. When I joined Radio Spectrum Management, I quickly realized how deep the rabbit hole goes and that I have only scratched the surface.\nThus Spectrum Efficiency was incorporated:\nDue to conflict of interests, I never pursued the dream of owning a company. I kept the name and it stands for:\n How efficient are you in delivering a specific communication given that you only have a certain amount of time to do it.\n The values that it is built on are\nProfessionalism  I want to share thoughts and have opinions about various topics within the telecommunications industry.  Accuracy  I want to always base my opinions on facts and provide a reproducible report.  Optimized  I want to provide the easiest most efficient way to consume this information.  ","description":"Radio Frequency Spectrum Management unleashed by data automation.","id":1,"section":"posts","tags":["contact","spectrum management","data automation","R","Dashboard"],"title":"Spectrum Efficiency","uri":"https://www.spectrumefficiency.co.nz/posts/contact-us/"},{"content":"I like building data process. A lot. And, unlike my stakeholders, I consider change, just the necessary step, that when implemented together, it makes a significant impact in their work life. Luckily for my stakeholders, I like resolving the business challenges even more.\nI also quite like data visualization â€“ charts and dashboards like sharable data interactions using the Shiny framework. Yes, I like looking at youtube videos of other people building data dashboards in my spare time.\nI amounted to more than ten+ years of experience in the telecommunication industry, and the last three years have been within the government.\nWhen not eagerly anticipating my next innovation challenge, I will be doing something daunting like diving, mountain biking, snowboarding, or else running or at the gym.\nMMIM - Victoria University of Wellington, New Zealand\nARE176\nGovernment Regulatory Practice Initiative level 4.\nLearn more and contribute on GitHub.\n","description":"Radio Frequency Spectrum Management unleashed by data automation.","id":2,"section":"","tags":["R","dashboard","profile","story","qualifications","experience","gender neutral","stakeholders","contact","spectrum management","data automation"],"title":"Spectrum Efficiency","uri":"https://www.spectrumefficiency.co.nz/about/"}]